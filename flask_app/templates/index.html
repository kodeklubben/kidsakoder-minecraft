{% extends "layout.html" %}
{% from "meeting_form.html" import meeting, meeting_scripts %}

{% block content %}

{{meeting(form, world)}}

<hr>

<div class="body-content">
    <h2>Dine m√∏ter:</h2>
    <div class="row panel-group">

    {% for meeting in meetings %}
    <div class="panel panel-default" id="meeting_id_{{ meeting.id }}">
        <div class="panel-heading">
            <h3 class="panel-title">
                {{ meeting.title }}
                <span class="pull-right">{{ meeting.start_time.strftime('%A %d.%m.%Y kl. %H:%M').decode('utf-8') }}</span>
            </h3>
        </div>
        <div class="panel-body">
            <span class="pull-left">
                Deltakere: {{ meeting.participant_count }}
            </span>
            <span class="pull-right" style="margin-right: 15px">
                <div class="row">
                    <a class="btn btn-default" style="width: 100%" href="{{ url_for('edit_meeting', meeting_id=meeting.id) }}">Rediger</a>
                </div>
                <div class="row">
                    <a class="btn btn-default glyphicon glyphicon-play"></a>
                    <a id="{{ meeting.id }}" class="del-btn btn btn-default glyphicon glyphicon-remove-circle"></a>
                </div>
            </span>
        </div>
    </div>
    {% endfor %}
    </div>
    <br>
    <a href=" {{ url_for('export_calendar') }} " class="row btn btn-default">Last ned iCalendar-fil til kalenderen din.</a>
</div>

{% endblock %}


{% block scripts %}

<script type=text/javascript>

$(document).ready(function(){
    $(".del-btn").click(function(){
        m_id = "#meeting_id_" + this.id;
        $.getJSON("delete_meeting/" + this.id, function(result){
            if (result.success) {
                $(m_id).hide();
            }
            else {

            }
        });
    });
});

</script>

{{meeting_scripts(set_tab)}}

{% endblock %}
